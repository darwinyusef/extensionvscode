<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comic Layout 01</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #0a0a0a;
      color: #fff;
      overflow: hidden;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    html {
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    .comic-page {
      width: 100vw;
      height: 100vh;
      display: grid;
      grid-template-columns: 66fr 33fr;
      grid-template-rows: 1fr 1fr;
      gap: 0;
      margin: 0;
      padding: 0;
    }

    .section-a {
      grid-column: 1;
      grid-row: 1 / 3;
      display: grid;
      grid-template-rows: 1fr 1fr;
      gap: 0;
    }

    .section-a-top {
      grid-row: 1;
      display: flex;
      overflow: hidden;
    }

    .section-a-bottom {
      grid-row: 2;
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 0;
    }

    .section-b {
      grid-column: 2;
      grid-row: 1 / 3;
      display: flex;
      overflow: hidden;
    }

    .panel {
      position: relative;
      overflow: hidden;
      border: none;
      transition: all 0.5s ease;
      filter: grayscale(1) brightness(0.5);
      opacity: 0.7;
      cursor: pointer;
      width: 100%;
      height: 100%;
    }

    .panel.active {
      filter: grayscale(0) brightness(1);
      opacity: 1;
      z-index: 10;
      box-shadow: inset 0 0 0 3px rgba(102, 126, 234, 0.8);
    }

    .panel-layer {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transition: transform 0.3s ease;
    }

    .panel-layer.background {
      z-index: 1;
    }

    .panel-layer.character {
      z-index: 2;
    }

    .panel:hover .panel-layer.background {
      transform: scale(1.05);
    }

    .panel:hover .panel-layer.character {
      transform: translateZ(20px) scale(1.02);
    }

    .panel-content {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 20px;
      z-index: 3;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
    }

    .dialogue {
      background: rgba(255, 255, 255, 0.95);
      color: #000;
      padding: 12px 18px;
      border-radius: 8px;
      font-size: 15px;
      line-height: 1.5;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      border: 2px solid rgba(0,0,0,0.1);
      margin-bottom: 10px;
      position: relative;
    }

    .dialogue:last-child {
      margin-bottom: 0;
    }

    .panel-number {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(102, 126, 234, 0.9);
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 18px;
      z-index: 10;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .demo-bg-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .demo-bg-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .demo-bg-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .demo-bg-4 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .demo-bg-5 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }

    .timeline-container {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(20, 20, 30, 0.95);
      padding: 15px 20px;
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .timeline-controls {
      display: flex;
      gap: 10px;
    }

    .control-btn {
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .control-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .control-btn.playing {
      background: #667eea;
      border-color: #667eea;
    }

    .timeline-bar {
      flex: 1;
      position: relative;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      cursor: pointer;
    }

    .timeline-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      border-radius: 3px;
      width: 0%;
      transition: width 0.3s ease;
    }

    .timeline-info {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.7);
      min-width: 100px;
      text-align: right;
    }

    @media (max-width: 768px) {
      .comic-page {
        grid-template-columns: 1fr;
        grid-template-rows: auto;
        height: auto;
        overflow-y: auto;
      }

      .section-a {
        grid-column: 1;
        grid-row: auto;
        height: 100vh;
      }

      .section-b {
        grid-column: 1;
        grid-row: auto;
        height: 50vh;
      }

      .section-a-bottom {
        grid-template-columns: 1fr;
      }

      .panel {
        min-height: 33vh;
      }
    }
  </style>
</head>
<body>
  <div class="comic-page">
    <div class="section-a">
      <div class="section-a-top">
        <div class="panel" data-panel="1" data-duration="30">
          <div class="panel-number">1</div>
          <div class="panel-layer background demo-bg-1"></div>
          <div class="panel-content">
            <div class="dialogue">Mi nombre es Yunara de la Orden Kinkou.</div>
            <div class="dialogue">He recorrido el mundo para llegar a Demacia.</div>
            <div class="dialogue">Para honrar a un héroe.</div>
          </div>
        </div>
      </div>

      <div class="section-a-bottom">
        <div class="panel" data-panel="2" data-duration="25">
          <div class="panel-number">2</div>
          <div class="panel-layer background demo-bg-2"></div>
          <div class="panel-content">
            <div class="dialogue">Para contar su verdad.</div>
          </div>
        </div>

        <div class="panel" data-panel="3" data-duration="25">
          <div class="panel-number">3</div>
          <div class="panel-layer background demo-bg-3"></div>
          <div class="panel-content">
            <div class="dialogue">Pero hay otra verdad.</div>
          </div>
        </div>

        <div class="panel" data-panel="4" data-duration="30">
          <div class="panel-number">4</div>
          <div class="panel-layer background demo-bg-4"></div>
          <div class="panel-content">
            <div class="dialogue">Xin Zhao dio su vida para salvarnos.</div>
            <div class="dialogue">Confió en Zaahen, el Darkin.</div>
          </div>
        </div>
      </div>
    </div>

    <div class="section-b">
      <div class="panel" data-panel="5" data-duration="40">
        <div class="panel-number">5</div>
        <div class="panel-layer background demo-bg-5"></div>
        <div class="panel-content">
          <div class="dialogue">He dejado atrás mi mundo de espías.</div>
          <div class="dialogue">Para entrar al suyo.</div>
          <div class="dialogue">Al reino que tanto amó.</div>
        </div>
      </div>
    </div>
  </div>

  <div class="timeline-container">
    <div class="timeline-controls">
      <button id="playPause" class="control-btn">▶</button>
      <button id="prev" class="control-btn">◀</button>
      <button id="next" class="control-btn">▶▶</button>
    </div>
    <div class="timeline-bar" id="timelineBar">
      <div class="timeline-progress" id="timelineProgress"></div>
    </div>
    <div class="timeline-info">
      <span id="currentTime">00:00</span> / <span id="totalTime">00:00</span>
    </div>
  </div>

  <script>
    class ComicLayout01 {
      constructor() {
        this.panels = Array.from(document.querySelectorAll('.panel[data-panel]'));
        this.currentIndex = 0;
        this.isPlaying = false;
        this.timeElapsed = 0;
        this.totalDuration = 0;
        this.interval = null;

        this.calculateTotalDuration();
        this.init();
      }

      calculateTotalDuration() {
        this.totalDuration = this.panels.reduce((sum, panel) => {
          return sum + parseInt(panel.dataset.duration || 30);
        }, 0);
      }

      init() {
        this.setupControls();
        this.setupPanelClicks();
        this.updateDisplay();
        this.activatePanel(0);
      }

      setupControls() {
        document.getElementById('playPause').addEventListener('click', () => this.togglePlay());
        document.getElementById('prev').addEventListener('click', () => this.previousPanel());
        document.getElementById('next').addEventListener('click', () => this.nextPanel());

        document.getElementById('timelineBar').addEventListener('click', (e) => {
          const rect = e.currentTarget.getBoundingClientRect();
          const clickX = e.clientX - rect.left;
          const percentage = clickX / rect.width;
          const targetTime = percentage * this.totalDuration;
          this.jumpToTime(targetTime);
        });
      }

      setupPanelClicks() {
        this.panels.forEach((panel, index) => {
          panel.addEventListener('click', () => this.jumpToPanel(index));
        });
      }

      togglePlay() {
        const btn = document.getElementById('playPause');
        if (this.isPlaying) {
          this.pause();
          btn.textContent = '▶';
          btn.classList.remove('playing');
        } else {
          this.play();
          btn.textContent = '⏸';
          btn.classList.add('playing');
        }
      }

      play() {
        this.isPlaying = true;
        this.interval = setInterval(() => {
          this.timeElapsed++;
          this.updateDisplay();

          let accumulatedTime = 0;
          for (let i = 0; i < this.panels.length; i++) {
            const duration = parseInt(this.panels[i].dataset.duration || 30);
            if (this.timeElapsed < accumulatedTime + duration) {
              if (this.currentIndex !== i) {
                this.activatePanel(i);
              }
              break;
            }
            accumulatedTime += duration;
          }

          if (this.timeElapsed >= this.totalDuration) {
            this.reset();
          }
        }, 1000);
      }

      pause() {
        this.isPlaying = false;
        clearInterval(this.interval);
      }

      reset() {
        this.pause();
        this.timeElapsed = 0;
        this.currentIndex = 0;
        this.activatePanel(0);
        this.updateDisplay();
        document.getElementById('playPause').textContent = '▶';
        document.getElementById('playPause').classList.remove('playing');
      }

      previousPanel() {
        const newIndex = Math.max(0, this.currentIndex - 1);
        this.jumpToPanel(newIndex);
      }

      nextPanel() {
        const newIndex = Math.min(this.panels.length - 1, this.currentIndex + 1);
        this.jumpToPanel(newIndex);
      }

      jumpToPanel(index) {
        let accumulatedTime = 0;
        for (let i = 0; i < index; i++) {
          accumulatedTime += parseInt(this.panels[i].dataset.duration || 30);
        }
        this.timeElapsed = accumulatedTime;
        this.activatePanel(index);
        this.updateDisplay();
      }

      jumpToTime(targetTime) {
        this.timeElapsed = Math.floor(targetTime);
        let accumulatedTime = 0;
        for (let i = 0; i < this.panels.length; i++) {
          const duration = parseInt(this.panels[i].dataset.duration || 30);
          if (this.timeElapsed < accumulatedTime + duration) {
            this.activatePanel(i);
            break;
          }
          accumulatedTime += duration;
        }
        this.updateDisplay();
      }

      activatePanel(index) {
        this.panels.forEach(p => p.classList.remove('active'));
        this.panels[index].classList.add('active');
        this.currentIndex = index;
      }

      updateDisplay() {
        const progress = (this.timeElapsed / this.totalDuration) * 100;
        document.getElementById('timelineProgress').style.width = `${progress}%`;

        document.getElementById('currentTime').textContent = this.formatTime(this.timeElapsed);
        document.getElementById('totalTime').textContent = this.formatTime(this.totalDuration);
      }

      formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      new ComicLayout01();
    });
  </script>
</body>
</html>
