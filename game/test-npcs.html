<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test NPCs Especializados</title>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.js"></script>

    <!-- Sistemas de NPCs base -->
    <script src="npc-system/npc.js"></script>

    <!-- Sistemas Especializados de NPCs -->
    <script src="npc-system/npc-king.js"></script>
    <script src="npc-system/npc-storyteller.js"></script>
    <script src="npc-system/npc-motivator.js"></script>
    <script src="npc-system/npc-enemy.js"></script>
    <script src="npc-system/npc-healer.js"></script>

    <!-- Estilos -->
    <link rel="stylesheet" href="npc-system/npc-styles.css">

    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
        }
        #game-container {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="game-container"></div>

    <script>
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            parent: 'game-container',
            backgroundColor: 0x1a4d2e,
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 0 },
                    debug: false
                }
            },
            scene: {
                create: create
            }
        };

        const game = new Phaser.Game(config);

        function create() {
            const scene = this;

            // Crear jugador
            const player = scene.add.circle(400, 300, 20, 0xff6b6b);
            scene.physics.add.existing(player);

            // Crear NPCs de prueba manualmente
            createTestNPCs(scene);

            // Texto de instrucciones
            scene.add.text(400, 50, 'Click en los NPCs para probarlos', {
                fontSize: '20px',
                color: '#fff'
            }).setOrigin(0.5);
        }

        function createTestNPCs(scene) {
            // NPC King
            const kingSprite = scene.add.circle(150, 300, 40, 0xFFD700);
            kingSprite.setInteractive({ useHandCursor: true });
            scene.add.text(150, 350, 'Rey', { fontSize: '14px', color: '#fff' }).setOrigin(0.5);

            const kingNPC = {
                id: 'king_test',
                name: 'Rey Arthur',
                role: 'Rey del CÃ³digo',
                position: { x: 150, y: 300 }
            };
            const kingBehavior = new NPCKing(scene, kingNPC);
            kingSprite.on('pointerdown', () => {
                window.currentKingNPC = kingBehavior;
                kingBehavior.interact();
            });

            // NPC Storyteller
            const storySprite = scene.add.circle(300, 300, 40, 0x8B4513);
            storySprite.setInteractive({ useHandCursor: true });
            scene.add.text(300, 350, 'Cuentahistorias', { fontSize: '14px', color: '#fff' }).setOrigin(0.5);

            const storyNPC = {
                id: 'story_test',
                name: 'El Sabio',
                role: 'Cuentahistorias'
            };
            const storyBehavior = new NPCStoryteller(scene, storyNPC);
            storySprite.on('pointerdown', () => {
                window.currentStoryteller = storyBehavior;
                storyBehavior.interact();
            });

            // NPC Motivator
            const motiSprite = scene.add.circle(450, 300, 40, 0xFF6B6B);
            motiSprite.setInteractive({ useHandCursor: true });
            scene.add.text(450, 350, 'Motivador', { fontSize: '14px', color: '#fff' }).setOrigin(0.5);

            const motiNPC = {
                id: 'moti_test',
                name: 'Coach',
                role: 'Motivador'
            };
            const motiBehavior = new NPCMotivator(scene, motiNPC);
            motiSprite.on('pointerdown', () => {
                window.currentMotivator = motiBehavior;
                motiBehavior.interact();
            });

            // NPC Enemy
            const enemySprite = scene.add.circle(600, 300, 40, 0x8B008B);
            enemySprite.setInteractive({ useHandCursor: true });
            scene.add.text(600, 350, 'Enemigo', { fontSize: '14px', color: '#fff' }).setOrigin(0.5);

            const enemyNPC = {
                id: 'enemy_test',
                name: 'Codificador Oscuro',
                role: 'Enemigo',
                maxHP: 5,
                rewards: { xp: 500, coins: 300, items: [{ id: 'key_js', name: 'Llave JS' }] }
            };
            const enemyBehavior = new NPCEnemy(scene, enemyNPC);
            enemySprite.on('pointerdown', () => {
                window.currentEnemy = enemyBehavior;
                enemyBehavior.interact();
            });

            // NPC Healer
            const healerSprite = scene.add.circle(150, 450, 40, 0x228B22);
            healerSprite.setInteractive({ useHandCursor: true });
            scene.add.text(150, 500, 'Curandero', { fontSize: '14px', color: '#fff' }).setOrigin(0.5);

            const healerNPC = {
                id: 'healer_test',
                name: 'Sanador',
                role: 'Curandero'
            };
            const healerBehavior = new NPCHealer(scene, healerNPC);
            healerSprite.on('pointerdown', () => {
                window.currentHealer = healerBehavior;
                healerBehavior.interact();
            });
        }
    </script>
</body>
</html>
